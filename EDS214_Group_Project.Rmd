---
title: "EDS 214 Group Project"
output: html_document
date: "2022-08-24"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(here)
```

```{r, message = FALSE, warning = FALSE}
#read in raw data 
PRM <- read_csv(here('/courses/EDS214/gg_girls/raw_data','RioMameyesPuenteRoto.csv'))
BQ1 <- read_csv(here('/courses/EDS214/gg_girls/raw_data', 'QuebradaCuenca1-Bisley.csv'))
BQ2 <- read_csv(here('/courses/EDS214/gg_girls/raw_data', 'QuebradaCuenca2-Bisley.csv'))
BQ3 <- read_csv(here('/courses/EDS214/gg_girls/raw_data', 'QuebradaCuenca2-Bisley.csv'))
```

```{r}
#select data for relevant variables (data cleaning)
PRM_clean <- PRM %>% 
  select(Sample_Date, `NO3-N`, K, `NH4-N`, Sample_ID)
BQ1_clean <- BQ1 %>% 
  select(Sample_Date, `NO3-N`, K, `NH4-N`, Sample_ID)
BQ2_clean <- BQ2 %>% 
  select(Sample_Date, `NO3-N`, K, `NH4-N`, Sample_ID)
BQ3_clean <- BQ3 %>% 
  select(Sample_Date, `NO3-N`, K, `NH4-N`, Sample_ID)|>
  mutate(Sample_ID = "Q3")
  
```

```{r}
#joining cleaned data
Joined <- bind_rows(BQ1_clean, BQ2_clean, BQ3_clean, PRM_clean) 

#add month, year, and month-year columns to joined data
Joined <- Joined %>% 
  mutate(Year = lubridate::year(Sample_Date), Month = lubridate::month(Sample_Date), monthyear = zoo::as.yearmon(paste(Year, Month), "%Y %m")) 

#subset joined data to select for years 1989-1992
Joined_Sub <- Joined %>% 
  filter(Year >=1989 & Year <= 1992)

#add mean K values to joined subset data 
 Joined_Sub <- Joined_Sub %>% 
  group_by(monthyear, Sample_ID) %>% 
  mutate(meanK = mean(K, na.rm=TRUE)) %>% 
  select(Sample_ID, monthyear, meanK) %>% 
  distinct(monthyear, meanK)

#add mean K values to joined data (including data for all available years)
Joined <- Joined %>% 
  group_by(monthyear, Sample_ID) %>% 
  mutate(meanK = mean(K, na.rm=TRUE)) %>% 
  select(Sample_ID, monthyear, meanK) %>% 
  distinct(monthyear, meanK)

```

```{r}
#create a ggplot of subsetted data
ggplot(data=Joined_Sub, aes(x=monthyear, y=meanK)) + geom_line(aes(color=Sample_ID, linetype=Sample_ID)) +
  theme(aspect.ratio = 1/3)
```
```{r}
#create a ggplot for all available data 
ggplot(data=Joined, aes(x=monthyear, y=meanK)) + geom_line(aes(color=Sample_ID, linetype=Sample_ID)) +
  theme(aspect.ratio = 1/3)
```








